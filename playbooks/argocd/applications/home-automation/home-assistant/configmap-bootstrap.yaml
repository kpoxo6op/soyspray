# playbooks/argocd/applications/home-automation/home-assistant/configmap-bootstrap.yaml
# Bootstrap configuration for Home Assistant
apiVersion: v1
kind: ConfigMap
metadata:
  name: home-assistant-bootstrap
  namespace: home-automation
  labels:
    app: home-assistant
data:
  configuration.yaml: |
    default_config:

    frontend:
      themes: !include_dir_merge_named themes

    http:
      use_x_forwarded_for: true
      trusted_proxies:
        - 10.0.0.0/8
        - 172.16.0.0/12
        - 192.168.0.0/16

    automation: !include automations.yaml
    script: !include scripts.yaml
    scene: !include scenes.yaml
  automations.yaml: |
    - id: door_open_10min
      alias: Door open
      triggers:
        - trigger: state
          entity_id: binary_sensor.front_door_contact
          to: "on"
          for:
            minutes: 10
      actions:
        - action: notify.mobile_app_pixel_9_pro_xl
          data:
            title: Door open
            message: Front door has been open for 10 minutes
      mode: single
